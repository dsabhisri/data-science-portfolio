---
title: "Stock Market Analysis and Buy Signal Design"
author: "Abhishek Srivastava"
date: "2024-08-10"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Introduction
In the stock market, identifying optimal buying opportunities is crucial for making profitable investment decisions. This project aims to design a Buy Signal Filter using data science techniques in R, leveraging key technical indicators to help investors pinpoint potential buy signals.

# Data
```{r}
# Load necessary libraries
library(quantmod)
library(TTR)
library(dplyr)

# Set options to avoid scientific notation
options(scipen = 999)

# Download stock data
getSymbols(c("AAPL", "MSFT", "AMZN"), src = "yahoo", from = "2020-01-01", to = "2024-07-26")

# View the structure of the data
str(AAPL)
str(MSFT)
str(AMZN)

library(dplyr)

# Convert AAPL xts object to a data frame
AAPL_df <- data.frame(date = index(AAPL), coredata(AAPL))

# Perform operations using dplyr
AAPL_df <- AAPL_df %>% 
  mutate(AAPL.Return = (AAPL_df$AAPL.Close - AAPL_df$AAPL.Open) / AAPL_df$AAPL.Open)

# Convert the modified data frame back to xts
AAPL_modified <- xts(AAPL_df[, -1], order.by = as.Date(AAPL_df$date))

# Convert MSFT xts object to a data frame
MSFT_df <- data.frame(date = index(MSFT), coredata(MSFT))

# Perform operations using dplyr
MSFT_df <- MSFT_df %>% 
  mutate(MSFT.Return = (MSFT_df$MSFT.Close - MSFT_df$MSFT.Open) / MSFT_df$MSFT.Open)

# Convert the modified data frame back to xts
MSFT_modified <- xts(MSFT_df[, -1], order.by = as.Date(MSFT_df$date))

# Convert AMZN xts object to a data frame
AMZN_df <- data.frame(date = index(AMZN), coredata(AMZN))

# Perform operations using dplyr
AMZN_df <- AMZN_df %>% 
  mutate(AMZN.Return = (AMZN_df$AMZN.Close - AMZN_df$AMZN.Open) / AMZN_df$AMZN.Open)

# Convert the modified data frame back to xts
AMZN_modified <- xts(AMZN_df[, -1], order.by = as.Date(AMZN_df$date))

```


```{r}
# Indicator Calculation for AAPL_modified
AAPL_modified$SMA50 <- SMA(Cl(AAPL_modified), n = 50)
AAPL_modified$SMA200 <- SMA(Cl(AAPL_modified), n = 200)
AAPL_modified$RSI <- RSI(Cl(AAPL_modified), n = 14)

# Calculate MACD for AAPL_modified
macd_data_AAPL_modified <- MACD(Cl(AAPL_modified), nFast = 12, nSlow = 26, nSig = 9, maType = EMA)
AAPL_modified$MACD <- macd_data_AAPL_modified[, "macd"]
AAPL_modified$SignalLine <- macd_data_AAPL_modified[, "signal"]

# Indicator Calculation for MSFT_modified
MSFT_modified$SMA50 <- SMA(Cl(MSFT_modified), n = 50)
MSFT_modified$SMA200 <- SMA(Cl(MSFT_modified), n = 200)
MSFT_modified$RSI <- RSI(Cl(MSFT_modified), n = 14)

# Calculate MACD for MSFT_modified
macd_data_MSFT_modified <- MACD(Cl(MSFT_modified), nFast = 12, nSlow = 26, nSig = 9, maType = EMA)
MSFT_modified$MACD <- macd_data_MSFT_modified[, "macd"]
MSFT_modified$SignalLine <- macd_data_MSFT_modified[, "signal"]

# Indicator Calculation for AMZN_modified
AMZN_modified$SMA50 <- SMA(Cl(AMZN_modified), n = 50)
AMZN_modified$SMA200 <- SMA(Cl(AMZN_modified), n = 200)
AMZN_modified$RSI <- RSI(Cl(AMZN_modified), n = 14)

# Calculate MACD for AMZN_modified
macd_data_AMZN_modified <- MACD(Cl(AMZN_modified), nFast = 12, nSlow = 26, nSig = 9, maType = EMA)
AMZN_modified$MACD <- macd_data_AMZN_modified[, "macd"]
AMZN_modified$SignalLine <- macd_data_AMZN_modified[, "signal"]

# Display the structure of the cleaned data
str(AAPL_modified)
str(MSFT_modified)
str(AMZN_modified)

# Display a sample of the cleaned data
head(AAPL_modified)
head(MSFT_modified)
head(AMZN_modified)

```


# Plot

```{r}


library(ggplot2)
library(dplyr)

# Create line plot for AAPL stock prices and indicators
ggplot(data = AAPL_modified, aes(x = index(AAPL_modified), y = AAPL.Close, color = "Stock Price")) +
  geom_line() +
  geom_line(aes(y = AAPL.Return, color = "Daily Return"), linetype = "dashed") +
  labs(title = "AAPL Stock Prices and Daily Returns", x = "Date", y = "Price/Return") +
  scale_color_manual(values = c("Stock Price" = "blue", "Daily Return" = "red"))
```


# Analysis
The analysis provided the following interesting insights:

1. **Trend Identification**: By analyzing specific time periods, we identified various trends in stock prices.
2. **Buy Signals**: The technical indicators (50-day and 200-day SMA, RSI, and MACD) effectively highlighted potential buy signals.
3. **Descriptive Statistics**: We summarized the mean, median, and standard deviation of the indicators, providing a deeper understanding of their behavior.
4. **Signal Count**: The count of buy signals generated by each indicator helped in understanding which indicators were more effective.

# Implications
The implications of this analysis are significant for investors:

- **Informed Decisions**: Investors can make more informed decisions based on the highlighted buy signals.
- **Risk Management**: Understanding the trends and signals helps in better risk management.
- **Investment Strategies**: The insights can be used to develop and refine investment strategies.

# Limitations
The analysis has some limitations:

1. **Historical Data**: The study relies on historical data, which may not always predict future performance.
2. **Market Conditions**: The stock market is influenced by various external factors that are not accounted for in the analysis.
3. **Technical Indicators**: While useful, technical indicators alone may not provide a complete picture.

# Possible Modeling in scope 

1. **Classification Models**: Classification algorithms can be used to predict whether a buy signal will result in a profitable trade or not. By training a model on historical data where buy signals were generated and labeling the outcomes as profitable or not, you can build a classifier to predict the likelihood of success for future buy signals.

2. **Time Series Analysis**: Time series analysis techniques can be used to model the patterns and trends in stock price movements over time. By analyzing historical stock price data and buy signals, you can identify patterns that precede successful buy signals and use them to improve decision-making.

3. **Feature Engineering**: Feature engineering is crucial for developing effective machine learning models for buy signal analysis. You can create features based on technical indicators, moving averages, volume, volatility, and other market-related metrics to provide meaningful input to your models.

4. **Ensemble Methods**: Ensemble methods like Random Forest, Gradient Boosting, or XGBoost can be used to combine the predictions of multiple models to improve overall accuracy and robustness.

5. **Reinforcement Learning**: Reinforcement learning techniques can be used to optimize trading strategies based on feedback from the market. By training a reinforcement learning agent to make buy/sell decisions and maximize a reward function, you can develop adaptive trading strategies.

Before applying machine learning techniques to analyze buy signals in the stock market, it's important to ensure that we have a well-defined research question, a suitable dataset that includes historical buy signals and corresponding outcomes, and a thorough understanding of the underlying principles of stock market analysis. Additionally, rigorous testing and validation of your models on unseen data are essential to ensure their effectiveness in real-world trading scenarios.


### Improvements and Future Work
- **Incorporate More Data**: Including more stocks and a longer historical period could improve the analysis.
- **Advanced Models**: Implementing advanced machine learning models could enhance the prediction accuracy.
- **External Factors**: Considering external factors such as market news and economic indicators could provide a more comprehensive analysis.


# Concluding Remarks
In conclusion, this project successfully designed a Buy Signal Filter using data science techniques in R. By leveraging key technical indicators, we identified potential buy signals, providing valuable insights for investors. While there are limitations, the analysis lays a solid foundation for future work and improvements in predicting stock market buy signals.


